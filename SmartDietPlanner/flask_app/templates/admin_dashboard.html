<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Smart Diet & Lifestyle Planner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body>
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">
                <i class="bi bi-heart-pulse me-2"></i>
                Smart Diet & Lifestyle Planner
            </a>
            <div class="ms-auto d-flex align-items-center">
                <span class="text-white me-3">
                    <i class="bi bi-shield-check me-2"></i>Admin: {{ session['username'] }}
                </span>
                <a href="{{ url_for('logout') }}" class="btn btn-danger btn-sm">
                    <i class="bi bi-box-arrow-right me-2"></i>Logout
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container-fluid">
        <div class="row">
            
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link {% if not view %}active{% endif %}" href="{{ url_for('admin_dashboard') }}">
                                <i class="bi bi-speedometer2 me-2"></i>Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'users' %}active{% endif %}" href="{{ url_for('admin_users') }}">
                                <i class="bi bi-people me-2"></i>Manage Users
                            </a>
                        </li>
                        <hr>
                        <li class="nav-item small text-muted ps-3">LOGS</li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'daily_logs' %}active{% endif %}" href="{{ url_for('admin_daily_logs') }}">
                                <i class="bi bi-calendar-day me-2"></i>Daily Logs
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'meal_logs' %}active{% endif %}" href="{{ url_for('admin_meal_logs') }}">
                                <i class="bi bi-cup-straw me-2"></i>Meal Logs
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'activity_logs' %}active{% endif %}" href="{{ url_for('admin_activity_logs') }}">
                                <i class="bi bi-activity me-2"></i>Activity Logs
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'mood_logs' %}active{% endif %}" href="{{ url_for('admin_mood_logs') }}">
                                <i class="bi bi-emoji-smile me-2"></i>Mood Logs
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'goals' %}active{% endif %}" href="{{ url_for('admin_goals') }}">
                                <i class="bi bi-bullseye me-2"></i>Goals
                            </a>
                        </li>
                        <hr>
                        <li class="nav-item small text-muted ps-3">MASTER DATA</li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'meals' %}active{% endif %}" href="{{ url_for('admin_meals') }}">
                                <i class="bi bi-egg-fried me-2"></i>View Meals
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'activities' %}active{% endif %}" href="{{ url_for('admin_activities') }}">
                                <i class="bi bi-bicycle me-2"></i>View Activities
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'add_meal' %}active{% endif %}" href="{{ url_for('admin_add_meal') }}">
                                <i class="bi bi-plus-circle me-2"></i>Add Meals
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'add_activity' %}active{% endif %}" href="{{ url_for('admin_add_activity') }}">
                                <i class="bi bi-plus-circle me-2"></i>Add Activities
                            </a>
                        </li>
                        <hr>
                        <li class="nav-item small text-muted ps-3">AI & REPORTS</li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'suggestions' %}active{% endif %}" href="{{ url_for('admin_suggestions') }}">
                                <i class="bi bi-lightbulb me-2"></i>Suggestions
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if view == 'reports' %}active{% endif %}" href="{{ url_for('admin_reports') }}">
                                <i class="bi bi-file-earmark-bar-graph me-2"></i>Reports
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            
            <!-- Main Content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                
                <!-- Dashboard Overview -->
                {% if not view %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-speedometer2 me-2"></i>Admin Dashboard
                    </h1>
                </div>
                
                <div class="row g-3 mb-4">
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #E8B4BC, #D89FA8);">
                                <i class="bi bi-people-fill"></i>
                            </div>
                            <h3>{{ total_users if total_users else 0 }}</h3>
                            <p class="text-muted mb-0">Total Users</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #C8D8C0, #A8C8A0);">
                                <i class="bi bi-calendar-check-fill"></i>
                            </div>
                            <h3>{{ total_logs if total_logs else 0 }}</h3>
                            <p class="text-muted mb-0">Daily Logs</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #F4D4A8, #E8C490);">
                                <i class="bi bi-egg-fried"></i>
                            </div>
                            <h3>{{ total_meal_logs if total_meal_logs else 0 }}</h3>
                            <p class="text-muted mb-0">Meal Logs</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #B4D4E8, #A0C4D8);">
                                <i class="bi bi-activity"></i>
                            </div>
                            <h3>{{ total_activity_logs if total_activity_logs else 0 }}</h3>
                            <p class="text-muted mb-0">Activity Logs</p>
                        </div>
                    </div>
                </div>
                
                <!-- Second Row Stats -->
                <div class="row g-3 mb-4">
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #DDA0DD, #BA55D3);">
                                <i class="bi bi-emoji-smile-fill"></i>
                            </div>
                            <h3>{{ total_mood_logs if total_mood_logs else 0 }}</h3>
                            <p class="text-muted mb-0">Mood Logs</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #98D8C8, #66B2A0);">
                                <i class="bi bi-bullseye"></i>
                            </div>
                            <h3>{{ total_goals if total_goals else 0 }}</h3>
                            <p class="text-muted mb-0">Goals Set</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #FFB347, #FF8C00);">
                                <i class="bi bi-lightbulb-fill"></i>
                            </div>
                            <h3>{{ total_suggestions if total_suggestions else 0 }}</h3>
                            <p class="text-muted mb-0">AI Suggestions</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #87CEEB, #4169E1);">
                                <i class="bi bi-file-earmark-bar-graph-fill"></i>
                            </div>
                            <h3>{{ total_reports if total_reports else 0 }}</h3>
                            <p class="text-muted mb-0">Reports Generated</p>
                        </div>
                    </div>
                </div>
                
                <!-- Third Row - Master Data Stats -->
                <div class="row g-3 mb-4">
                    <div class="col-md-6">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #FADADD, #E8B4BC);">
                                <i class="bi bi-basket-fill"></i>
                            </div>
                            <h3>{{ total_meals if total_meals else 0 }}</h3>
                            <p class="text-muted mb-0">Meals in Database</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="stat-card">
                            <div class="stat-icon" style="background: linear-gradient(135deg, #C8D8C0, #98C890);">
                                <i class="bi bi-bicycle"></i>
                            </div>
                            <h3>{{ total_activities if total_activities else 0 }}</h3>
                            <p class="text-muted mb-0">Activities in Database</p>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Users Table -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-people me-2"></i>Recent Users</h5>
                            </div>
                            <div class="card-body">
                                {% if recent_users %}
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Username</th>
                                                <th>Name</th>
                                                <th>Email</th>
                                                <th>Joined</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for user in recent_users %}
                                            <tr>
                                                <td>{{ user[0] }}</td>
                                                <td>{{ user[1] }}</td>
                                                <td>{{ user[2] }} {{ user[3] }}</td>
                                                <td>{{ user[4] }}</td>
                                                <td>{{ user[5] }}</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                                {% else %}
                                <p class="text-muted">No users found</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Manage Users View -->
                {% if view == 'users' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-people me-2"></i>Manage Users
                    </h1>
                    <a href="{{ url_for('admin_create_user') }}" class="btn btn-primary">
                        <i class="bi bi-person-plus me-2"></i>Add New User
                    </a>
                </div>
                
                <!-- Search and Filter Bar -->
                <div class="search-filter-bar">
                    <form method="GET" action="{{ url_for('admin_users') }}" class="row g-3">
                        <div class="col-md-6">
                            <div class="search-input">
                                <i class="bi bi-search"></i>
                                <input type="text" class="form-control" name="search_name" 
                                       value="{{ search_name if search_name else '' }}" 
                                       placeholder="Search by name or username...">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <select class="form-select" name="filter_gender">
                                <option value="">All Genders</option>
                                <option value="Male" {% if filter_gender == 'Male' %}selected{% endif %}>Male</option>
                                <option value="Female" {% if filter_gender == 'Female' %}selected{% endif %}>Female</option>
                                <option value="Other" {% if filter_gender == 'Other' %}selected{% endif %}>Other</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button type="submit" class="btn btn-success w-100">
                                <i class="bi bi-funnel me-2"></i>Filter
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Users Table -->
                <div class="card">
                    <div class="card-body">
                        {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                            <div class="alert alert-{{ category }} alert-dismissible fade show">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                            {% endfor %}
                        {% endif %}
                        {% endwith %}
                        
                        {% if users %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Username</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Gender</th>
                                        <th>Activity</th>
                                        <th>Created</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for user in users %}
                                    <tr>
                                        <td>{{ user[0] }}</td>
                                        <td><strong>{{ user[1] }}</strong></td>
                                        <td>{{ user[3] }} {{ user[4] }}</td>
                                        <td>{{ user[2] }}</td>
                                        <td>
                                            <span class="badge bg-{{ 'info' if user[5] == 'Male' else 'warning' }}">
                                                {{ user[5] }}
                                            </span>
                                        </td>
                                        <td>{{ user[8] }}</td>
                                        <td>{{ user[9] }}</td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <a href="{{ url_for('admin_view_user', user_id=user[0]) }}" 
                                                   class="btn btn-info" title="View Details">
                                                    <i class="bi bi-eye"></i>
                                                </a>
                                                <a href="{{ url_for('admin_update_user', user_id=user[0]) }}" 
                                                   class="btn btn-warning" title="Edit">
                                                    <i class="bi bi-pencil"></i>
                                                </a>
                                                <button type="button" class="btn btn-danger" 
                                                        data-bs-toggle="modal" 
                                                        data-bs-target="#deleteModal{{ user[0] }}"
                                                        title="Delete">
                                                    <i class="bi bi-trash"></i>
                                                </button>
                                            </div>
                                            
                                            <!-- Delete Confirmation Modal -->
                                            <div class="modal fade" id="deleteModal{{ user[0] }}" tabindex="-1">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title">Confirm Delete</h5>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            Are you sure you want to delete user <strong>{{ user[1] }}</strong>? This action cannot be undone.
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                            <form method="POST" action="{{ url_for('admin_delete_user', user_id=user[0]) }}" style="display:inline;">
                                                                <button type="submit" class="btn btn-danger">Delete User</button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% else %}
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle me-2"></i>No users found.
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
                
                <!-- View User Details -->
                {% if view == 'view_user' and user %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-person-circle me-2"></i>User Details
                    </h1>
                    <a href="{{ url_for('admin_users') }}" class="btn btn-secondary">
                        <i class="bi bi-arrow-left me-2"></i>Back to Users
                    </a>
                </div>
                
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-person me-2"></i>Personal Information</h5>
                            </div>
                            <div class="card-body text-center">
                                <div class="user-avatar mb-3">
                                    {{ user[3][0] if user[3] else 'U' }}{{ user[4][0] if user[4] else '' }}
                                </div>
                                <h4>{{ user[3] }} {{ user[4] }}</h4>
                                <p class="text-muted">@{{ user[1] }}</p>
                                <hr>
                                <div class="text-start">
                                    <p><i class="bi bi-envelope me-2"></i><strong>Email:</strong> {{ user[2] }}</p>
                                    <p><i class="bi bi-calendar me-2"></i><strong>DOB:</strong> {{ user[5] if user[5] else 'N/A' }}</p>
                                    <p><i class="bi bi-gender-ambiguous me-2"></i><strong>Gender:</strong> {{ user[6] }}</p>
                                    <p>
                                        <i class="bi bi-shield me-2"></i><strong>Role:</strong> 
                                        {% if user[10] == 1 %}
                                            <span class="badge bg-primary">Admin</span>
                                        {% else %}
                                            <span class="badge bg-success">User</span>
                                        {% endif %}
                                    </p>
                                    <p><i class="bi bi-clock me-2"></i><strong>Joined:</strong> {{ user[11] }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-8">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5><i class="bi bi-heart-pulse me-2"></i>Health Metrics</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <strong>Weight:</strong> {{ user[7] }} kg
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <strong>Height:</strong> {{ user[8] }} cm
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <strong>BMI:</strong> 
                                        {% if user[7] and user[8] %}
                                            {{ "%.2f"|format((user[7] / ((user[8]/100) ** 2))) }}
                                        {% else %}
                                            N/A
                                        {% endif %}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <strong>Activity Level:</strong> {{ user[9] }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5><i class="bi bi-bullseye me-2"></i>Goals</h5>
                            </div>
                            <div class="card-body">
                                {% if goals %}
                                    {% for goal in goals %}
                                    <div class="mb-2 p-2 border rounded">
                                        <strong>{{ goal[1] }}</strong>: {{ goal[3] }} / {{ goal[2] }}
                                        <span class="badge bg-{{ 'success' if goal[6] == 'Active' else 'secondary' }} float-end">
                                            {{ goal[6] }}
                                        </span>
                                    </div>
                                    {% endfor %}
                                {% else %}
                                    <p class="text-muted">No goals set</p>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-calendar-check me-2"></i>Recent Logs</h5>
                            </div>
                            <div class="card-body">
                                {% if logs %}
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>Date</th>
                                                    <th>Calories In</th>
                                                    <th>Calories Out</th>
                                                    <th>Water (L)</th>
                                                    <th>Weight (kg)</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for log in logs %}
                                                <tr>
                                                    <td>{{ log[0] }}</td>
                                                    <td>{{ log[1] }}</td>
                                                    <td>{{ log[2] }}</td>
                                                    <td>{{ log[3] }}</td>
                                                    <td>{{ log[4] }}</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                {% else %}
                                    <p class="text-muted">No logs available</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Create User Form -->
                {% if view == 'create_user' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-person-plus me-2"></i>Create New User
                    </h1>
                    <a href="{{ url_for('admin_users') }}" class="btn btn-secondary">
                        <i class="bi bi-arrow-left me-2"></i>Back to Users
                    </a>
                </div>
                
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-form me-2"></i>User Information</h5>
                            </div>
                            <div class="card-body">
                                {% with messages = get_flashed_messages(with_categories=true) %}
                                {% if messages %}
                                    {% for category, message in messages %}
                                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                                        {{ message }}
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                    </div>
                                    {% endfor %}
                                {% endif %}
                                {% endwith %}
                                
                                <form method="POST" action="{{ url_for('admin_create_user') }}">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Username *</label>
                                            <input type="text" class="form-control" name="username" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Email *</label>
                                            <input type="email" class="form-control" name="email" required>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">First Name *</label>
                                            <input type="text" class="form-control" name="first_name" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Last Name *</label>
                                            <input type="text" class="form-control" name="last_name" required>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Password *</label>
                                            <input type="password" class="form-control" name="password" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Date of Birth</label>
                                            <input type="date" class="form-control" name="date_of_birth">
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Gender</label>
                                            <select class="form-select" name="gender">
                                                <option value="Male">Male</option>
                                                <option value="Female">Female</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Weight (kg)</label>
                                            <input type="number" step="0.1" class="form-control" name="weight">
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Height (cm)</label>
                                            <input type="number" step="0.1" class="form-control" name="height">
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Activity Level</label>
                                            <select class="form-select" name="activity_level">
                                                <option value="Sedentary">Sedentary</option>
                                                <option value="Light">Light</option>
                                                <option value="Moderate" selected>Moderate</option>
                                                <option value="Active">Active</option>
                                                <option value="Very Active">Very Active</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Role</label>
                                            <div class="form-check mt-2">
                                                <input class="form-check-input" type="checkbox" name="is_admin" id="isAdmin">
                                                <label class="form-check-label" for="isAdmin">
                                                    Grant Admin Privileges
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">
                                        <i class="bi bi-save me-2"></i>Create User
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Update User Form -->
                {% if view == 'update_user' and user %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-pencil me-2"></i>Update User
                    </h1>
                    <a href="{{ url_for('admin_users') }}" class="btn btn-secondary">
                        <i class="bi bi-arrow-left me-2"></i>Back to Users
                    </a>
                </div>
                
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-form me-2"></i>Edit User: {{ user[1] }}</h5>
                            </div>
                            <div class="card-body">
                                {% with messages = get_flashed_messages(with_categories=true) %}
                                {% if messages %}
                                    {% for category, message in messages %}
                                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                                        {{ message }}
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                    </div>
                                    {% endfor %}
                                {% endif %}
                                {% endwith %}
                                
                                <form method="POST" action="{{ url_for('admin_update_user', user_id=user[0]) }}">
                                    <div class="mb-3">
                                        <label class="form-label">Username</label>
                                        <input type="text" class="form-control" value="{{ user[1] }}" disabled>
                                        <small class="text-muted">Username cannot be changed</small>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Email *</label>
                                            <input type="email" class="form-control" name="email" value="{{ user[2] }}" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Date of Birth</label>
                                            <input type="date" class="form-control" name="date_of_birth" value="{{ user[5] }}">
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">First Name *</label>
                                            <input type="text" class="form-control" name="first_name" value="{{ user[3] }}" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Last Name *</label>
                                            <input type="text" class="form-control" name="last_name" value="{{ user[4] }}" required>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Gender</label>
                                            <select class="form-select" name="gender">
                                                <option value="Male" {% if user[6] == 'Male' %}selected{% endif %}>Male</option>
                                                <option value="Female" {% if user[6] == 'Female' %}selected{% endif %}>Female</option>
                                                <option value="Other" {% if user[6] == 'Other' %}selected{% endif %}>Other</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Weight (kg)</label>
                                            <input type="number" step="0.1" class="form-control" name="weight" value="{{ user[7] }}">
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Height (cm)</label>
                                            <input type="number" step="0.1" class="form-control" name="height" value="{{ user[8] }}">
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Activity Level</label>
                                            <select class="form-select" name="activity_level">
                                                <option value="Sedentary" {% if user[9] == 'Sedentary' %}selected{% endif %}>Sedentary</option>
                                                <option value="Light" {% if user[9] == 'Light' %}selected{% endif %}>Light</option>
                                                <option value="Moderate" {% if user[9] == 'Moderate' %}selected{% endif %}>Moderate</option>
                                                <option value="Active" {% if user[9] == 'Active' %}selected{% endif %}>Active</option>
                                                <option value="Very Active" {% if user[9] == 'Very Active' %}selected{% endif %}>Very Active</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Role</label>
                                            <div class="form-check mt-2">
                                                <input class="form-check-input" type="checkbox" name="is_admin" id="isAdmin" {% if user[10] == 1 %}checked{% endif %}>
                                                <label class="form-check-label" for="isAdmin">
                                                    Grant Admin Privileges
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-warning">
                                        <i class="bi bi-save me-2"></i>Update User
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Daily Logs View -->
                {% if view == 'daily_logs' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-calendar-day me-2"></i>Daily Logs
                    </h1>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Date</th>
                                        <th>Calories In</th>
                                        <th>Calories Burned</th>
                                        <th>Water (L)</th>
                                        <th>Sleep (hrs)</th>
                                        <th>Weight (kg)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if daily_logs %}
                                    {% for log in daily_logs %}
                                    <tr>
                                        <td>{{ log[0] }}</td>
                                        <td>{{ log[1] }}</td>
                                        <td>{{ log[2] }}</td>
                                        <td><span class="text-success">{{ log[3] }}</span></td>
                                        <td><span class="text-danger">{{ log[4] }}</span></td>
                                        <td>{{ log[5] }}</td>
                                        <td>{{ log[6] }}</td>
                                        <td>{{ log[7] }}</td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="8" class="text-center text-muted">No daily logs found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Meal Logs View -->
                {% if view == 'meal_logs' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-cup-straw me-2"></i>Meal Logs
                    </h1>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Meal</th>
                                        <th>Time</th>
                                        <th>Quantity</th>
                                        <th>Calories</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if meal_logs %}
                                    {% for log in meal_logs %}
                                    <tr>
                                        <td>{{ log[0] }}</td>
                                        <td>{{ log[1] }}</td>
                                        <td><strong>{{ log[2] }}</strong></td>
                                        <td>{{ log[3] }}</td>
                                        <td>{{ log[4] }}</td>
                                        <td><span class="text-success">{{ log[5] }} kcal</span></td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="6" class="text-center text-muted">No meal logs found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Activity Logs View -->
                {% if view == 'activity_logs' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-activity me-2"></i>Activity Logs
                    </h1>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Activity</th>
                                        <th>Time</th>
                                        <th>Duration (min)</th>
                                        <th>Calories Burned</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if activity_logs %}
                                    {% for log in activity_logs %}
                                    <tr>
                                        <td>{{ log[0] }}</td>
                                        <td>{{ log[1] }}</td>
                                        <td><strong>{{ log[2] }}</strong></td>
                                        <td>{{ log[3] }}</td>
                                        <td>{{ log[4] }}</td>
                                        <td><span class="text-danger">{{ log[5] }} kcal</span></td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="6" class="text-center text-muted">No activity logs found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Goals View -->
                {% if view == 'goals' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-bullseye me-2"></i>User Goals
                    </h1>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Goal Type</th>
                                        <th>Target</th>
                                        <th>Current</th>
                                        <th>Progress</th>
                                        <th>Start Date</th>
                                        <th>Target Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if goals %}
                                    {% for goal in goals %}
                                    <tr>
                                        <td>{{ goal[0] }}</td>
                                        <td>{{ goal[1] }}</td>
                                        <td><span class="badge bg-info">{{ goal[2] }}</span></td>
                                        <td>{{ goal[3] }}</td>
                                        <td>{{ goal[4] }}</td>
                                        <td>
                                            {% if goal[3] and goal[4] %}
                                            <div class="progress" style="height: 20px;">
                                                {% set progress = ((goal[4] / goal[3]) * 100) | int %}
                                                <div class="progress-bar bg-success" style="width: {{ progress if progress <= 100 else 100 }}%">
                                                    {{ progress }}%
                                                </div>
                                            </div>
                                            {% else %}
                                            <span class="text-muted">N/A</span>
                                            {% endif %}
                                        </td>
                                        <td>{{ goal[6] }}</td>
                                        <td>{{ goal[7] }}</td>
                                        <td>
                                            <span class="badge {% if goal[5] == 'Active' %}bg-success{% elif goal[5] == 'Completed' %}bg-primary{% else %}bg-secondary{% endif %}">
                                                {{ goal[5] }}
                                            </span>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="9" class="text-center text-muted">No goals found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Add Meal View -->
                {% if view == 'add_meal' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-plus-circle me-2"></i>Add New Meal
                    </h1>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-egg-fried me-2"></i>Meal Details</h5>
                            </div>
                            <div class="card-body">
                                <form method="POST" action="{{ url_for('admin_add_meal') }}">
                                    <div class="mb-3">
                                        <label class="form-label">Meal Name *</label>
                                        <input type="text" class="form-control" name="meal_name" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Category *</label>
                                        <select class="form-select" name="meal_category" required>
                                            <option value="">Select Category</option>
                                            <option value="Breakfast">Breakfast</option>
                                            <option value="Lunch">Lunch</option>
                                            <option value="Dinner">Dinner</option>
                                            <option value="Snack">Snack</option>
                                        </select>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Calories *</label>
                                            <input type="number" step="0.1" class="form-control" name="calories" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Protein (g)</label>
                                            <input type="number" step="0.1" class="form-control" name="protein" value="0">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Carbs (g)</label>
                                            <input type="number" step="0.1" class="form-control" name="carbs" value="0">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Fats (g)</label>
                                            <input type="number" step="0.1" class="form-control" name="fats" value="0">
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="bi bi-plus-circle me-2"></i>Add Meal
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-list me-2"></i>Existing Meals</h5>
                            </div>
                            <div class="card-body" style="max-height: 400px; overflow-y: auto;">
                                {% if meals %}
                                <table class="table table-sm table-hover">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Category</th>
                                            <th>Calories</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for meal in meals %}
                                        <tr>
                                            <td>{{ meal[1] }}</td>
                                            <td><span class="badge bg-info">{{ meal[2] }}</span></td>
                                            <td>{{ meal[3] }}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                                {% else %}
                                <p class="text-muted">No meals in database yet</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Add Activity View -->
                {% if view == 'add_activity' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-plus-circle me-2"></i>Add New Activity
                    </h1>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-bicycle me-2"></i>Activity Details</h5>
                            </div>
                            <div class="card-body">
                                <form method="POST" action="{{ url_for('admin_add_activity') }}">
                                    <div class="mb-3">
                                        <label class="form-label">Activity Name *</label>
                                        <input type="text" class="form-control" name="activity_name" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Category *</label>
                                        <select class="form-select" name="activity_category" required>
                                            <option value="">Select Category</option>
                                            <option value="Cardio">Cardio</option>
                                            <option value="Strength">Strength</option>
                                            <option value="Flexibility">Flexibility</option>
                                            <option value="Sports">Sports</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Calories per Minute *</label>
                                        <input type="number" step="0.1" class="form-control" name="calories_per_minute" required>
                                        <small class="text-muted">Average calories burned per minute of activity</small>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Intensity Level</label>
                                        <select class="form-select" name="intensity_level">
                                            <option value="Low">Low</option>
                                            <option value="Moderate">Moderate</option>
                                            <option value="High">High</option>
                                            <option value="Very High">Very High</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="bi bi-plus-circle me-2"></i>Add Activity
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-list me-2"></i>Existing Activities</h5>
                            </div>
                            <div class="card-body" style="max-height: 400px; overflow-y: auto;">
                                {% if activities %}
                                <table class="table table-sm table-hover">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Category</th>
                                            <th>Cal/Min</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for act in activities %}
                                        <tr>
                                            <td>{{ act[1] }}</td>
                                            <td><span class="badge bg-info">{{ act[2] }}</span></td>
                                            <td>{{ act[3] }}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                                {% else %}
                                <p class="text-muted">No activities in database yet</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Suggestions View -->
                {% if view == 'suggestions' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-lightbulb me-2"></i>AI Suggestions
                    </h1>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Type</th>
                                        <th>Suggestion</th>
                                        <th>Priority</th>
                                        <th>Status</th>
                                        <th>Created</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if suggestions %}
                                    {% for s in suggestions %}
                                    <tr>
                                        <td>{{ s[0] }}</td>
                                        <td>{{ s[1] }}</td>
                                        <td><span class="badge bg-info">{{ s[2] }}</span></td>
                                        <td style="max-width: 300px;">{{ s[3][:100] }}{% if s[3]|length > 100 %}...{% endif %}</td>
                                        <td>
                                            <span class="badge {% if s[5] == 'High' %}bg-danger{% elif s[5] == 'Medium' %}bg-warning{% else %}bg-secondary{% endif %}">
                                                {{ s[5] }}
                                            </span>
                                        </td>
                                        <td>
                                            <span class="badge {% if s[6] == 'Completed' %}bg-success{% elif s[6] == 'Accepted' %}bg-primary{% elif s[6] == 'Rejected' %}bg-danger{% else %}bg-secondary{% endif %}">
                                                {{ s[6] }}
                                            </span>
                                        </td>
                                        <td>{{ s[7] }}</td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="7" class="text-center text-muted">No suggestions found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Reports View -->
                {% if view == 'reports' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-file-earmark-bar-graph me-2"></i>Health Reports
                    </h1>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Type</th>
                                        <th>Period</th>
                                        <th>Calories In</th>
                                        <th>Calories Out</th>
                                        <th>Avg Weight</th>
                                        <th>Change</th>
                                        <th>Goals</th>
                                        <th>Generated</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if reports %}
                                    {% for r in reports %}
                                    <tr>
                                        <td>{{ r[0] }}</td>
                                        <td>{{ r[1] }}</td>
                                        <td><span class="badge bg-info">{{ r[2] }}</span></td>
                                        <td>{{ r[3] }} to {{ r[4] }}</td>
                                        <td>{{ r[5] }}</td>
                                        <td>{{ r[6] }}</td>
                                        <td>{{ r[7] }} kg</td>
                                        <td>
                                            {% if r[8] and r[8] > 0 %}
                                            <span class="text-success">+{{ r[8] }}</span>
                                            {% elif r[8] and r[8] < 0 %}
                                            <span class="text-danger">{{ r[8] }}</span>
                                            {% else %}
                                            <span class="text-muted">0</span>
                                            {% endif %}
                                        </td>
                                        <td>{{ r[9] }}</td>
                                        <td>{{ r[11] }}</td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="10" class="text-center text-muted">No reports found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Mood Logs View -->
                {% if view == 'mood_logs' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-emoji-smile me-2"></i>Mood Logs
                    </h1>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>User</th>
                                        <th>Mood Rating</th>
                                        <th>Stress Level</th>
                                        <th>Energy Level</th>
                                        <th>Notes</th>
                                        <th>Log Time</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if mood_logs %}
                                    {% for m in mood_logs %}
                                    <tr>
                                        <td>{{ m[0] }}</td>
                                        <td>{{ m[1] }}</td>
                                        <td>
                                            {% for i in range(m[2]) %}
                                            <i class="bi bi-star-fill text-warning"></i>
                                            {% endfor %}
                                            {% for i in range(5 - m[2]) %}
                                            <i class="bi bi-star text-muted"></i>
                                            {% endfor %}
                                        </td>
                                        <td>
                                            <span class="badge {% if m[3] == 'Low' %}bg-success{% elif m[3] == 'Moderate' %}bg-warning{% else %}bg-danger{% endif %}">
                                                {{ m[3] }}
                                            </span>
                                        </td>
                                        <td>
                                            <span class="badge {% if m[4] == 'High' %}bg-success{% elif m[4] == 'Moderate' %}bg-warning{% else %}bg-danger{% endif %}">
                                                {{ m[4] }}
                                            </span>
                                        </td>
                                        <td style="max-width: 200px;">{{ m[5][:50] if m[5] else '' }}{% if m[5] and m[5]|length > 50 %}...{% endif %}</td>
                                        <td>{{ m[6] }}</td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="7" class="text-center text-muted">No mood logs found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Meals Master Table View -->
                {% if view == 'meals' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-egg-fried me-2"></i>Meals Database
                    </h1>
                    <a href="{{ url_for('admin_add_meal') }}" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Add New Meal
                    </a>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Meal Name</th>
                                        <th>Category</th>
                                        <th>Calories</th>
                                        <th>Protein</th>
                                        <th>Carbs</th>
                                        <th>Fats</th>
                                        <th>Fiber</th>
                                        <th>Serving</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if meals %}
                                    {% for meal in meals %}
                                    <tr>
                                        <td>{{ meal[0] }}</td>
                                        <td><strong>{{ meal[1] }}</strong></td>
                                        <td><span class="badge bg-info">{{ meal[2] }}</span></td>
                                        <td>{{ meal[3] }} kcal</td>
                                        <td>{{ meal[4] }}g</td>
                                        <td>{{ meal[5] }}g</td>
                                        <td>{{ meal[6] }}g</td>
                                        <td>{{ meal[7] }}g</td>
                                        <td>{{ meal[8] }}</td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="9" class="text-center text-muted">No meals found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Activities Master Table View -->
                {% if view == 'activities' %}
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">
                        <i class="bi bi-bicycle me-2"></i>Activities Database
                    </h1>
                    <a href="{{ url_for('admin_add_activity') }}" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Add New Activity
                    </a>
                </div>
                
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Activity Name</th>
                                        <th>Category</th>
                                        <th>Cal/Min</th>
                                        <th>Intensity</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if activities %}
                                    {% for act in activities %}
                                    <tr>
                                        <td>{{ act[0] }}</td>
                                        <td><strong>{{ act[1] }}</strong></td>
                                        <td><span class="badge bg-info">{{ act[2] }}</span></td>
                                        <td>{{ act[3] }}</td>
                                        <td>
                                            <span class="badge {% if act[4] == 'Low' %}bg-success{% elif act[4] == 'Moderate' %}bg-warning{% elif act[4] == 'High' %}bg-danger{% else %}bg-dark{% endif %}">
                                                {{ act[4] }}
                                            </span>
                                        </td>
                                        <td style="max-width: 250px;">{{ act[5] }}</td>
                                    </tr>
                                    {% endfor %}
                                    {% else %}
                                    <tr>
                                        <td colspan="6" class="text-center text-muted">No activities found</td>
                                    </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endif %}
                
            </main>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
